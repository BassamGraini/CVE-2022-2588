Vagrant.configure("2") do |config|
  config.vm.box = "ubuntu/focal64"
  config.vm.host_name = "BoxExploit2022-2588"
   config.vm.provider "virtualbox" do |vb|
     vb.memory = "2048"
     vb.cpus = "1"
   end


   config.ssh.config = "/home/graini/Graini/9rayawsff/TheorieDivers/Reseau_Secu/DevoirSecu/CVE-2022-2588/sshConfig.txt"
   config.vm.provision "shell", inline: <<-SHELL
     apt-get update
     apt-get install -y  git gcc gdb
     useradd -m -s /bin/bash -U simpleUser
     su -c "printf 'cd /home/simpleUser\nsudo su simpleUser' >> .bash_profile" -s /bin/sh vagrant
     cd /tmp/
     wget -c https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.0.10/linux-headers-5.0.10-050010_5.0.10-050010.201904270832_all.deb
     wget -c https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.0.10/linux-headers-5.0.10-050010-generic_5.0.10-050010.201904270832_amd64.deb
     wget -c https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.0.10/linux-image-unsigned-5.0.10-050010-generic_5.0.10-050010.201904270832_amd64.deb
     wget -c https://kernel.ubuntu.com/~kernel-ppa/mainline/v5.0.10/linux-modules-5.0.10-050010-generic_5.0.10-050010.201904270832_amd64.deb
     sudo dpkg -i *.deb
     sudo sed -i '6s/.*/GRUB_DEFAULT="1>2"/' /etc/default/grub
     sudo update-grub
     sudo update-grub
     cd /home/simpleUser
     git clone https://github.com/BassamGraini/CVE-2022-2588.git
     sudo chown -R simpleUser /home/simpleUser/CVE-2022-2588
     sudo reboot
     


   SHELL
 


end
